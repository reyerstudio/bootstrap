#!/usr/bin/env bash

CMD=$1

if [ "$CMD" != "init" ]; then
  #set -x
  set -e
fi

# Platform specific
OSNAME="$(uname -s)"
case "$OSNAME" in
  "Darwin")
    READLINK="greadlink"
    DISTRIB="osx"
    DISTRIB_VERSION=$(sw_vers -productVersion)
    ;;
  "Linux")
    READLINK="readlink"
    DISTRIB=$(cat /etc/os-release | grep '^ID=' | cut -d'=' -f2 | sed s/\"//g)
    DISTRIB_VERSION=$(cat /etc/os-release | grep '^VERSION_ID=' | cut -d'=' -f2 | sed s/\"//g)
    ;;
esac

SCRIPTDIR=$(dirname "$($READLINK -f "${BASH_SOURCE[0]}")")
FUNCDIR=$SCRIPTDIR/../func
LIBEXECDIR=$SCRIPTDIR/../libexec

. $FUNCDIR/functions.sh
COMMANDS=$(commands)

if [ -z "$CMD" ]; then
  launch 'help'
elif [ $CMD == "-h" ] || [ $CMD == "--help" ]; then
  shift
  launch 'help' $*
elif [[ "$COMMANDS" =~ "$CMD" ]]; then
  shift
  launch $CMD $*
else
  echo "ra: '$CMD' isn't a ra command. See 'ra help'"
  exit 1
fi